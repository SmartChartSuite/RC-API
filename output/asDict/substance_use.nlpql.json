{"name": "substance_use.nlpql", "content": "\n// Phenotype library name\nphenotype \" - substance use\" version \"1\";\n\n// # Referenced libraries #\ninclude ClarityCore version \"1.0\" called Clarity;\n\n// Termsets\n\ntermset mg_sub_alc_terms_terms: [\n    \"abusing alcohol\", \"etoh\", \"alcohol consumption\", \"wine\", \"tequila\", \"alcohol use\", \"whisky\", \"alcohol abuse\", \"gin\", \"vodka\", \"beer\", \"rum\", \"whiskey\"\n];\n\n\n\n\ntermset mg_sub_tobacco_terms_terms: [\n    \"cigarette\", \"vaping\", \"tobacco\", \"vape\", \"cigarettes\", \"e-cigarettes\", \"cigars\", \"packs per day\", \"vapes\"\n];\n\n\n\n// Data Entities\n\ndefine final mg_sub_tobacco_icd:\n    Clarity.CQLExecutionTask({\n        \"task_index\": 0,\n        cql: \"\"\"\n                \n        library Retrieve2 version '1.0'\n\n        using FHIR version '3.0.0'\n\n        include FHIRHelpers version '3.0.0' called FHIRHelpers\n\n        codesystem \"LOINC\": 'http://loinc.org'\n        codesystem \"SNOMED\": '2.16.840.1.113883.6.96'\n        codesystem \"RxNorm\": 'http://www.nlm.nih.gov/research/umls/rxnorm'\n        codesystem \"CPT\": 'http://www.ama-assn.org/go/cpt'\n        codesystem \"ICD9\": '2.16.840.1.113883.6.42'\n        codesystem \"ICD10\": '2.16.840.1.113883.6.3'\n        codesystem USCoreEthnicitySystem: '2.16.840.1.113883.6.238' \n        codesystem RelationshipType: '2.16.840.1.113883.4.642.3.449'\n\n        \n        \n\n        context Patient\n\n  \n\n\n        define \"mg_sub_tobacco_icd_concepts\": Concept {\n            Code 'O99.33' from \"ICD10CM\"\n        }\n\n\n\n\n       define \"mg_sub_tobacco_icd\": \n            \t [Observation: Code in \"mg_sub_tobacco_icd_concepts\"]\n\n\n\n             \"\"\"\n    });\n\n\n\ndefine final mg_sub_alc_sct:\n    Clarity.CQLExecutionTask({\n        \"task_index\": 0,\n        cql: \"\"\"\n                \n        library Retrieve2 version '1.0'\n\n        using FHIR version '3.0.0'\n\n        include FHIRHelpers version '3.0.0' called FHIRHelpers\n\n        codesystem \"LOINC\": 'http://loinc.org'\n        codesystem \"SNOMED\": '2.16.840.1.113883.6.96'\n        codesystem \"RxNorm\": 'http://www.nlm.nih.gov/research/umls/rxnorm'\n        codesystem \"CPT\": 'http://www.ama-assn.org/go/cpt'\n        codesystem \"ICD9\": '2.16.840.1.113883.6.42'\n        codesystem \"ICD10\": '2.16.840.1.113883.6.3'\n        codesystem USCoreEthnicitySystem: '2.16.840.1.113883.6.238' \n        codesystem RelationshipType: '2.16.840.1.113883.4.642.3.449'\n\n        \n        \n\n        context Patient\n\n  \n\n\n        define \"mg_sub_alc_sct_concepts\": Concept {\n            Code '427013000' from \"SNOMED\"\n        }\n\n\n\n\n       define \"mg_sub_alc_sct\": \n            \t [Observation: Code in \"mg_sub_alc_sct_concepts\"]\n\n\n\n             \"\"\"\n    });\n\n\n\ndefine final mg_sub_tobacco_terms:\n    Clarity.ProviderAssertion({\n      termset: [mg_sub_tobacco_terms_terms]\n    });\n                    \n\n\n\ndefine final mg_sub_tobacco_sct:\n    Clarity.CQLExecutionTask({\n        \"task_index\": 0,\n        cql: \"\"\"\n                \n        library Retrieve2 version '1.0'\n\n        using FHIR version '3.0.0'\n\n        include FHIRHelpers version '3.0.0' called FHIRHelpers\n\n        codesystem \"LOINC\": 'http://loinc.org'\n        codesystem \"SNOMED\": '2.16.840.1.113883.6.96'\n        codesystem \"RxNorm\": 'http://www.nlm.nih.gov/research/umls/rxnorm'\n        codesystem \"CPT\": 'http://www.ama-assn.org/go/cpt'\n        codesystem \"ICD9\": '2.16.840.1.113883.6.42'\n        codesystem \"ICD10\": '2.16.840.1.113883.6.3'\n        codesystem USCoreEthnicitySystem: '2.16.840.1.113883.6.238' \n        codesystem RelationshipType: '2.16.840.1.113883.4.642.3.449'\n\n        \n        \n\n        context Patient\n\n  \n\n\n        define \"mg_sub_tobacco_sct_concepts\": Concept {\n            Code '100801000119107' from \"SNOMED\"\n        }\n\n\n\n\n       define \"mg_sub_tobacco_sct\": \n            \t [Observation: Code in \"mg_sub_tobacco_sct_concepts\"]\n\n\n\n             \"\"\"\n    });\n\n\n\ndefine final mg_sub_alc_terms:\n    Clarity.ProviderAssertion({\n      termset: [mg_sub_alc_terms_terms]\n    });\n                    \n\n\n\ndefine final mg_sub_alc_icd:\n    Clarity.CQLExecutionTask({\n        \"task_index\": 0,\n        cql: \"\"\"\n                \n        library Retrieve2 version '1.0'\n\n        using FHIR version '3.0.0'\n\n        include FHIRHelpers version '3.0.0' called FHIRHelpers\n\n        codesystem \"LOINC\": 'http://loinc.org'\n        codesystem \"SNOMED\": '2.16.840.1.113883.6.96'\n        codesystem \"RxNorm\": 'http://www.nlm.nih.gov/research/umls/rxnorm'\n        codesystem \"CPT\": 'http://www.ama-assn.org/go/cpt'\n        codesystem \"ICD9\": '2.16.840.1.113883.6.42'\n        codesystem \"ICD10\": '2.16.840.1.113883.6.3'\n        codesystem USCoreEthnicitySystem: '2.16.840.1.113883.6.238' \n        codesystem RelationshipType: '2.16.840.1.113883.4.642.3.449'\n\n        \n        \n\n        context Patient\n\n  \n\n\n        define \"mg_sub_alc_icd_concepts\": Concept {\n            Code 'O99.310' from \"ICD10CM\"\n        }\n\n\n\n\n       define \"mg_sub_alc_icd\": \n            \t [Observation: Code in \"mg_sub_alc_icd_concepts\"]\n\n\n\n             \"\"\"\n    });\n\n\n// Operations\n\n\n\n"}